import{r as n,u as S,a as j,j as e,S as v,L as N,g,T as E,b as q,h as T,d as R}from"./index-CtXn_0-F.js";import{E as Q}from"./ErrorState-VtqgCvxY.js";import{a as z}from"./format-mZWKQBzJ.js";import"./ExclamationTriangleIcon-BX0D6seO.js";function A({title:o,titleId:u,...h},f){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:f,"aria-labelledby":u},h),o?n.createElement("title",{id:u},o):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const B=n.forwardRef(A);function _(){const o=S(),u=j(t=>t.cart.cartList),h=j(t=>t.cart.finalTotal),[f,w]=n.useState(!0),[C,l]=n.useState(!1),[i,m]=n.useState(null),x=n.useRef(null),y=async(t,a)=>{l(!0);const s=i.find(p=>p.id===t),r=a==="plus"?1:-1,c=s.qty+r,d=i.map(p=>p.id===t?{...p,qty:c}:p);m(d),x.current&&clearTimeout(x.current),x.current=setTimeout(async()=>{await b(t,d),l(!1)},500)},k=t=>{const a=t.target.value,s=t.target.dataset.id;(a===""||!isNaN(a))&&m(r=>r.map(c=>c.id===s?{...c,qty:a}:c))},I=async t=>{l(!0);const a=t.target.dataset.id,s=parseInt(t.target.value,10);let r=s;isNaN(s)||s<1?r=1:s>99&&(r=99);const c=i.map(d=>d.id===a?{...d,qty:r}:d);m(c),await b(a,c),l(!1)},b=async(t,a)=>{const s=a.find(r=>r.id===t);await R(t,{product_id:s.product_id,qty:s.qty}),o(g()),l(!1)},L=async t=>{m(a=>a.filter(r=>r.id!==t)),await T(t),o(g()),l(!1)};return n.useEffect(()=>{(async()=>{try{o(g())}catch(a){E.fire({position:"top",icon:"warning",title:"Something Wrong...",color:"#fff",iconColor:"#fff",background:"#ff8f40"}),q.error(a.message,a)}finally{w(!1)}})()},[o]),n.useEffect(()=>()=>{x.current&&clearTimeout(x.current)},[]),n.useEffect(()=>{m([...u])},[u]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center",children:[!i&&(f?e.jsx(v,{}):e.jsx(Q,{})),!f&&i&&(i?.length>0?e.jsxs("div",{className:"max-w-250 w-[90%] m-auto",children:[e.jsx("div",{className:"my-4",children:e.jsx("h1",{className:"text-center text-3xl font-bold text-primary-dark",children:"Shopping Cart"})}),e.jsx("ul",{className:"divide-y divide-gray-200 border-t border-b border-gray-200",children:i.map(t=>e.jsxs("li",{className:"flex py-6 items-center lg:justify-around gap-4",children:[e.jsx("div",{className:"size-20 lg:size-30",children:e.jsx("img",{className:"rounded-main w-full h-full object-cover",src:t.product.imageUrl||"https://dummyimage.com/600x400/eeeeee/fff",alt:"cover"})}),e.jsxs("div",{className:"flex-1 flex flex-col gap-4 lg:gap-8 lg:flex-row",children:[e.jsxs("div",{className:"text-gray-900 lg:w-1/2 flex gap-6 items-center",children:[e.jsx("p",{className:"text-md",children:t.product.title}),e.jsxs("span",{className:"text-sm font-medium",children:[" ","$",t.product.price," "]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"mx-auto w-fit inline-flex items-center border border-[--color-brand-secondary]/20 rounded-lg overflow-hidden bg-white shadow-sm",children:[e.jsx("button",{className:"px-3 py-2 text-secondary hover:bg-gray-100 transition-colors active:scale-95 select-none font-bold cursor-pointer disabled:text-gray-300 disabled:cursor-not-allowed",onClick:()=>y(t.id,"minus"),disabled:t.qty<=1,children:"－"}),e.jsx("input",{type:"number",value:t.qty,min:1,max:99,className:"w-12 text-center border-x border-[--color-brand-secondary]/10 py-2 font-poppins font-medium text-secondary focus:outline-none [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none","data-id":t.id,onChange:k,onBlur:I}),e.jsx("button",{className:"px-3 py-2 text-secondary hover:bg-gray-100 transition-colors active:scale-95 select-none font-bold cursor-pointer disabled:text-gray-300 disabled:cursor-not-allowed",onClick:()=>y(t.id,"plus"),disabled:t.qty>=99,children:"＋"})]}),e.jsx("div",{className:"p-2",children:e.jsx("button",{className:"text-red-500  hover:text-red-800 cursor-pointer",onClick:()=>L(t.id),children:e.jsx(B,{className:"size-5"})})})]})]})]},t.id))}),e.jsxs("div",{className:"mb-4 p-4 flex justify-between",children:[e.jsxs("div",{className:"",children:[e.jsx("h2",{className:"text-xl font-medium",children:"Estimated total"}),e.jsx("p",{className:"text-sm font-normal text-gray-400",children:"Shipping and taxes will be calculated at checkout."})]}),e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"text-xl lg:text-3xl ",children:C?e.jsx(v,{}):`$${z(h,",")}`})})]}),e.jsx("div",{className:"mb-4",children:e.jsx(N,{to:"/checkout",children:e.jsx("button",{className:"w-full px-4 bg-primary hover:bg-accent text-white py-2 rounded-button transition-colors",children:"Checkout"})})})]}):e.jsxs("div",{className:"flex flex-col gap-4 items-center",children:[e.jsx("h1",{className:"text-3xl text-primary font-bold",children:"Your cart is empty"}),e.jsx(N,{to:"/products",children:e.jsx("button",{className:"w-fit p-2 text-base text-white rounded-button bg-accent/90 hover:bg-accent cursor-pointer",children:"Continue Shopping"})})]}))]})})}export{_ as default};
