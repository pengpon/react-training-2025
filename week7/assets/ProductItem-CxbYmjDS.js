import{u as P,a as E,c as $,r as n,j as e,S as g,T as q,b as h,d as Q,e as _,g as B}from"./index-CtXn_0-F.js";import{a as R}from"./products-CXqVBi6q.js";import{E as U}from"./ErrorState-VtqgCvxY.js";import{a as b}from"./format-mZWKQBzJ.js";import"./ExclamationTriangleIcon-BX0D6seO.js";function G(){const y=P(),i=E(t=>t.cart.cartList),j=$(),{id:d}=j,[u,v]=n.useState(!0),[a,N]=n.useState(null),[w,m]=n.useState(""),[o,c]=n.useState(1),[C,p]=n.useState(!1),[k,x]=n.useState(!1),l=n.useRef(null),S=t=>{m(t.target.src)},f=t=>{const s=t.target.dataset.type;c(s==="plus"?r=>(Number(r)||0)+1:r=>(Number(r)||0)-1)},I=t=>{const s=t.target.value;(s===""||/^[0-9\b]+$/.test(s))&&c(s)},T=()=>{o||c(0)},L=async()=>{p(!0);const t=i.findIndex(s=>s.product_id===a.id);try{t>=0?await Q(i[t].id,{product_id:a.id,qty:i[t].qty+Number(o)}):await _({product_id:a.id,qty:o}),x(!0),l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{x(!1)},2e3),y(B())}catch(s){h.error(s.message,s)}finally{p(!1)}};return n.useEffect(()=>{d&&(async s=>{try{const r=await R(s);N(r?.data?.product),m(r.data?.product?.imageUrl)}catch(r){q.fire({position:"top",icon:"warning",title:"Something Wrong...",color:"#fff",iconColor:"#fff",background:"#ff8f40"}),h.error(r.message,r)}finally{v(!1)}})(d)},[d]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center",children:!a&&(u?e.jsx(g,{}):e.jsx(U,{}))}),!u&&a&&e.jsx("div",{className:"min-h-screen p-8",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2 lg:grid-cols-2 lg:gap:6",children:[e.jsx("div",{className:"group",children:e.jsxs("figure",{className:"",children:[e.jsx("img",{className:"w-full object-cover mb-2 rounded-main",src:w||"https://dummyimage.com/600x400/eeeeee/fff",alt:"cover"}),e.jsx("div",{className:"grid grid-cols-3 justify-start gap-2",children:a?.imagesUrl?.map((t,s)=>e.jsx("div",{className:"cursor-pointer",onClick:S,children:e.jsx("img",{className:"rounded-main",src:t||"https://dummyimage.com/600x400/eeeeee/fff",alt:"others"})},`${t}-${s}`))})]})}),e.jsxs("div",{className:"flex flex-col group",children:[e.jsxs("div",{className:"flex-1 px-4 flex flex-col gap-2",children:[e.jsx("h1",{className:"font-bold text-3xl text-secondary mb-4",children:a.title}),e.jsxs("div",{className:"text-xl flex gap-2 items-center mb-2",children:[e.jsxs("span",{className:"font-bold",children:["$",b(a.price)]}),e.jsxs("span",{className:"text-sm text-content-muted font-medium line-through italic",children:["$",b(a.origin_price)]})]}),e.jsx("p",{className:"text-justify",children:a.description})]}),e.jsx("div",{className:"w-full h-0.5 bg-gray-100 my-4"}),e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"mx-auto w-fit inline-flex items-center border border-[--color-brand-secondary]/20 rounded-lg overflow-hidden bg-white shadow-sm",children:[e.jsx("button",{className:"px-3 py-2 text-secondary hover:bg-gray-100 transition-colors active:scale-95 select-none font-bold cursor-pointer disabled:text-gray-300 disabled:cursor-not-allowed","data-type":"minus",onClick:f,disabled:o===0,children:"－"}),e.jsx("input",{type:"number",value:o,min:"1",className:"w-12 text-center border-x border-[--color-brand-secondary]/10 py-2 font-poppins font-medium text-secondary focus:outline-none [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",onChange:I,onBlur:T}),e.jsx("button",{className:"px-3 py-2 text-secondary hover:bg-gray-100 transition-colors active:scale-95 select-none font-bold cursor-pointer","data-type":"plus",onClick:f,children:"＋"})]}),e.jsx("button",{className:"px-4 bg-primary hover:bg-primary-dark text-white rounded-button transition-colors cursor-pointer disabled:bg-gray-300 disabled:cursor-not-allowed",onClick:L,children:C?e.jsx(g,{}):k?e.jsx("div",{className:"flex justify-center items-center gap-2 animate-success-pop",children:e.jsx("svg",{className:"w-8 h-8",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{className:"animate-draw-check",d:"M5 13l4 4L19 7"})})}):"Add To Cart"})]})})]})]})})]})}export{G as default};
