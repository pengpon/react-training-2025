import{u as L,r as n,j as e}from"./index-BXv429K9.js";import{a as P}from"./products-BEdlm8VO.js";import{f as A,u as E,a as $}from"./cart-DeIssSsx.js";import{E as q}from"./ErrorState-CDXe5_jR.js";import{S as g}from"./Spinner-Berbx5BC.js";import{T as Q,l as h}from"./axiosInstance-Chy4COHr.js";import{a as y}from"./format-mZWKQBzJ.js";import"./ExclamationTriangleIcon-BexStJ9F.js";function D(){const b=L(),{id:d}=b,[u,j]=n.useState(!0),[r,v]=n.useState(null),[N,m]=n.useState(""),[i,c]=n.useState(1),[w,p]=n.useState(!1),[C,f]=n.useState(!1),l=n.useRef(null),k=a=>{m(a.target.src)},x=a=>{const t=a.target.dataset.type;c(t==="plus"?s=>(Number(s)||0)+1:s=>(Number(s)||0)-1)},I=a=>{const t=a.target.value;(t===""||/^[0-9\b]+$/.test(t))&&c(t)},S=()=>{i||c(0)},T=async()=>{p(!0);const t=(await A()).data.data.carts,s=t.findIndex(o=>o.product_id===r.id);try{s>=0?await E(t[s].id,{product_id:r.id,qty:t[s].qty+i}):await $({product_id:r.id,qty:i}),f(!0),l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{f(!1)},2e3)}catch(o){h.error(o.message,o)}finally{p(!1)}};return n.useEffect(()=>{d&&(async t=>{try{const s=await P(t);v(s?.data?.product),m(s.data?.product?.imageUrl)}catch(s){Q.fire({position:"top",icon:"warning",title:"Something Wrong...",color:"#fff",iconColor:"#fff",background:"#ff8f40"}),h.error(s.message,s)}finally{j(!1)}})(d)},[d]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center",children:!r&&(u?e.jsx(g,{}):e.jsx(q,{}))}),!u&&r&&e.jsx("div",{className:"min-h-screen p-8",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2 lg:grid-cols-2 lg:gap:6",children:[e.jsx("div",{className:"group",children:e.jsxs("figure",{className:"",children:[e.jsx("img",{className:"w-full object-cover mb-2 rounded-main",src:N||"https://dummyimage.com/600x400/eeeeee/fff",alt:"cover"}),e.jsx("div",{className:"grid grid-cols-3 justify-start gap-2",children:r?.imagesUrl?.map((a,t)=>e.jsx("div",{className:"cursor-pointer",onClick:k,children:e.jsx("img",{className:"rounded-main",src:a||"https://dummyimage.com/600x400/eeeeee/fff",alt:"others"})},`${a}-${t}`))})]})}),e.jsxs("div",{className:"flex flex-col group",children:[e.jsxs("div",{className:"flex-1 px-4 flex flex-col gap-2",children:[e.jsx("h1",{className:"font-bold text-3xl text-secondary mb-4",children:r.title}),e.jsxs("div",{className:"text-xl flex gap-2 items-center mb-2",children:[e.jsxs("span",{className:"font-bold",children:["$",y(r.price)]}),e.jsxs("span",{className:"text-sm text-content-muted font-medium line-through italic",children:["$",y(r.origin_price)]})]}),e.jsx("p",{className:"text-justify",children:r.description})]}),e.jsx("div",{className:"w-full h-0.5 bg-gray-100 my-4"}),e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"mx-auto w-fit inline-flex items-center border border-[--color-brand-secondary]/20 rounded-lg overflow-hidden bg-white shadow-sm",children:[e.jsx("button",{className:"px-3 py-2 text-secondary hover:bg-gray-100 transition-colors active:scale-95 select-none font-bold cursor-pointer disabled:text-gray-300 disabled:cursor-not-allowed","data-type":"minus",onClick:x,disabled:i===0,children:"－"}),e.jsx("input",{type:"number",value:i,min:"1",className:"w-12 text-center border-x border-[--color-brand-secondary]/10 py-2 font-poppins font-medium text-secondary focus:outline-none [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",onChange:I,onBlur:S}),e.jsx("button",{className:"px-3 py-2 text-secondary hover:bg-gray-100 transition-colors active:scale-95 select-none font-bold cursor-pointer","data-type":"plus",onClick:x,children:"＋"})]}),e.jsx("button",{className:"px-4 bg-primary hover:bg-primary-dark text-white rounded-button transition-colors cursor-pointer disabled:bg-gray-300 disabled:cursor-not-allowed",onClick:T,children:w?e.jsx(g,{}):C?e.jsx("div",{className:"flex justify-center items-center gap-2 animate-success-pop",children:e.jsx("svg",{className:"w-8 h-8",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{className:"animate-draw-check",d:"M5 13l4 4L19 7"})})}):"Add To Cart"})]})})]})]})})]})}export{D as default};
